---
title: "Project"
author: "Drake Smith"
date: "`r format(Sys.Date(), '%B %e, %Y')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(pso)
```

``` {r}
# Define the Rosenbrock function
rosenbrock <- function(x) {
  sum(100 * (x[2:length(x)] - x[1:(length(x) - 1)]^2)^2 + (1 - x[1:(length(x) - 1)])^2)
}

# Set up bounds and other parameters
lower_bound <- rep(-2, 10)  # Lower bounds for each dimension
upper_bound <- rep(2, 10)   # Upper bounds for each dimension
num_dimensions <- length(lower_bound)  # Number of dimensions
num_particles <- 50  # Number of particles in the swarm
num_iterations <- 100  # Number of iterations

# Run PSO optimization
result <- psoptim(rep(NA, num_dimensions),
                  fn = rosenbrock,
                  lower = lower_bound,
                  upper = upper_bound,
                  control = list(maxit = num_iterations, trace = 1))

# Display the optimal solution
cat("Optimal value:", result$par, "\n")
cat("Minimum value:", result$value, "\n")
```

```{r}
set.seed(1)
## Rastrigin function
psoptim(rep(NA,2),function(x) 20+sum(x^2-10*cos(2*pi*x)),
lower=-5,upper=5,control=list(abstol=1e-8))
set.seed(1)
## Rastrigin function - local refinement with L-BFGS-B on improvements
psoptim(rep(NA,2),function(x) 20+sum(x^2-10*cos(2*pi*x)),
lower=-5,upper=5,control=list(abstol=1e-8,hybrid="improved"))
## Griewank function
psoptim(rep(NA,2),function(x) sum(x*x)/4000-prod(cos(x/sqrt(1:2)))+1,
lower=-100,upper=100,control=list(abstol=1e-2))
set.seed(1)
## Rastrigin function with reporting
o <- psoptim(rep(NA,2),function(x) 20+sum(x^2-10*cos(2*pi*x)),
lower=-5,upper=5,control=list(abstol=1e-8,trace=1,REPORT=1,
trace.stats=TRUE))
## Not run:
plot(o$stats$it,o$stats$error,log="y",xlab="It",ylab="Error")
```
